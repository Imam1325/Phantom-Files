# ===============================================
# Phantom Daemon - Main Configuration
# ===============================================

# --- Системные пути ---
# Определяет, где демон хранит свои файлы.
# Для безопасности рекомендуется использовать абсолютные пути, 
# особенно для /var/log.
paths:
  # Куда будут развертываться файлы-ловушки.
  traps_dir: "/tmp/phantom_traps"
  
  # Директория для хранения логов инцидентов.
  # Лучше использовать /var/log/phantom для продакшена.
  logs_dir: "/tmp/phantom_logs"
  
  # Путь к папке с шаблонами для генератора.
  templates: "resources/templates"
  
  # Путь к манифесту, который описывает, какие ловушки создавать.
  manifest: "config/traps_manifest.yaml"

# --- Настройки Песочницы (Sandbox) ---
# Управляет поведением Docker-контейнера при реакции на инцидент.
sandbox:
  image: "phantom-forensics:v1"
  command: "tcpdump -i eth0 -w /evidence/capture.pcap"

  
  # Сколько секунд контейнер будет работать, прежде чем будет автоматически уничтожен.
  timeout_seconds: 60
  
  # Изоляция сети. Если true, контейнер не сможет выйти в интернет.
  # Рекомендуется true для максимальной безопасности.
  network_disabled: true
  
  # Префикс для имен контейнеров, чтобы их было легко найти.
  container_prefix: "phantom_forensics"

# --- Настройки Сенсоров ---
# Управляет поведением модуля мониторинга.
sensors:
  # Тип сенсора для использования.
  # В MVP используется 'inotify'. В будущем можно добавить 'ebpf'.
  driver: "inotify"
  
  # Игнорировать события от этих пользователей (например, от админа).
  # Полезно для тестов, чтобы не ловить самого себя.
  ignore_users:
    - "root"